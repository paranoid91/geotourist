!function(){var a="jstarbox-data",e=".jstarbox",t={average:.5,stars:5,buttons:5,ghosting:!1,changeable:!0,autoUpdateAverage:!1},s={destroy:function(){this.removeData(a),this.unbind(e).find("*").unbind(e),this.removeClass("starbox"),this.empty()},getValue:function(){var e=this.data(a);return e.opts.currentValue},setValue:function(e){var t=this.data(a),s=arguments[1]||t.positioner.width(),r=arguments[2];r&&t.ghost.css({width:""+e*s+"px"}),t.colorbar.css({width:""+e*s+"px"}),t.opts.currentValue=e},getOption:function(e){var t=this.data(a);return t.opts[e]},setOption:function(e,t){var s=this.data(a);"changeable"===e&&t===!1&&s.positioner.triggerHandler("mouseleave"),s.opts[e]=t,"stars"===e?s.methods.update_stars():"average"===e&&this.starbox("setValue",t,null,!0)},markAsRated:function(){var e=this.data(a);e.positioner.addClass("rated")}};jQuery.fn.extend({starbox:function(r){return r.constructor===String&&s[r]?s[r].apply(this,Array.prototype.slice.call(arguments,1))||this:(r=jQuery.extend({},t,r),this.each(function(t){var o=jQuery(this),n=jQuery.extend({},r),i={opts:n,methods:{}};o.data(a,i);var d=i.positioner=jQuery("<div/>").addClass("positioner"),l=i.stars=jQuery("<div/>").addClass("stars").appendTo(d),u=i.ghost=jQuery("<div/>").addClass("ghost").hide().appendTo(l),c=(i.colorbar=jQuery("<div/>").addClass("colorbar").appendTo(l),i.star_holder=jQuery("<div/>").addClass("star_holder").appendTo(l));o.empty().addClass("starbox").append(d),i.methods.update_stars=function(){c.empty();for(var a=0;a<n.stars;a++){jQuery("<div/>").addClass("star").addClass("star-"+a).appendTo(c)}s.setOption.call(o,"average",n.average)},i.methods.update_stars(),d.bind("mousemove"+e,function(a){if(n.changeable){n.ghosting&&u.show();var e=d.width(),t=a.layerX;void 0===t&&(t=a.pageX-d.offset().left);var r=t/e;n.buttons&&(r*=n.buttons,r=Math.floor(r),r+=1,r/=n.buttons),d.addClass("hover"),s.setValue.call(o,r,e),o.starbox("setValue",r,e),o.triggerHandler("starbox-value-moved",r)}}),d.bind("mouseleave"+e,function(a){n.changeable&&(u.hide(),d.removeClass("hover"),s.setValue.call(o,n.average))}),d.bind("click"+e,function(a){if(n.changeable){n.autoUpdateAverage&&(s.markAsRated.call(o),s.setOption.call(o,"average",n.currentValue));var e=o.triggerHandler("starbox-value-changed",n.currentValue);!isNaN(parseFloat(e))&&isFinite(e)&&s.setOption.call(o,"average",e),"once"===n.changeable&&s.setOption.call(o,"changeable",!1)}})}),this)}})}();